<?php
/**
 * Sample Policy Content for Testing
 * 
 * This file contains sample credit policy content that can be used
 * for testing the policy management system.
 */

if (!defined('ABSPATH')) {
    exit;
}

/**
 * Get sample policy content
 */
function get_sample_policy_content() {
    return '
# DAYSTAR MULTI-PURPOSE CO-OPERATIVE SOCIETY LTD
## CREDIT POLICY

### 1. INTRODUCTION

This Credit Policy outlines the framework within which Daystar Multi-Purpose Co-operative Society Ltd (the "SACCO") extends credit facilities to its members. The policy is designed to ensure prudent lending practices, minimize credit risk, and promote the financial well-being of both the SACCO and its members.

### 2. OBJECTIVES

The primary objectives of this Credit Policy are to:

- Provide clear guidelines for loan origination, approval, and management
- Establish consistent criteria for evaluating creditworthiness
- Minimize credit risk and loan losses
- Ensure compliance with regulatory requirements
- Promote responsible lending practices
- Protect the interests of all members

### 3. LOAN ELIGIBILITY CRITERIA

#### 3.1 General Requirements

To be eligible for a loan from the SACCO, a member must:

- Be an active member in good standing
- Have maintained membership for a minimum of six (6) months
- Have a minimum share capital contribution of KES 5,000
- Have made regular monthly contributions totaling at least KES 12,000
- Have no outstanding loan in default
- Provide satisfactory guarantors as required
- Submit all required documentation

#### 3.2 Specific Requirements by Loan Type

**Development Loans:**
- Minimum membership period: 6 months
- Minimum share capital: KES 5,000
- Maximum loan amount: 4 times share capital or KES 2,000,000 (whichever is lower)
- Repayment period: Up to 36 months
- Guarantors required: Yes (minimum 2)

**Emergency Loans:**
- Minimum membership period: 6 months
- Maximum loan amount: KES 100,000
- Repayment period: Up to 12 months
- Emergency documentation required

**School Fees Loans:**
- Minimum membership period: 6 months
- Maximum loan amount: KES 500,000
- Repayment period: Up to 12 months
- School fee structure required

### 4. LOAN APPLICATION PROCESS

#### 4.1 Application Submission

All loan applications must be submitted through:
- Online member portal
- Physical application at SACCO offices
- Authorized agents (where applicable)

#### 4.2 Required Documentation

Standard documentation includes:
- Completed loan application form
- Copy of national ID/passport
- Recent payslip (for employed members)
- Bank statements (last 3 months)
- Guarantor information and consent
- Collateral documentation (if applicable)

#### 4.3 Application Review Process

1. **Initial Review**: Verification of completeness and eligibility
2. **Credit Assessment**: Evaluation of creditworthiness and capacity
3. **Committee Review**: Assessment by Credit Committee
4. **Approval/Rejection**: Final decision communication
5. **Disbursement**: Fund transfer upon approval

### 5. CREDIT ASSESSMENT CRITERIA

#### 5.1 Character Assessment

Evaluation includes:
- Payment history with the SACCO
- Credit history with other institutions
- Reputation in the community
- Compliance with SACCO rules and regulations

#### 5.2 Capacity Assessment

Analysis of:
- Current income and employment stability
- Debt-to-income ratio
- Monthly cash flow analysis
- Other financial obligations

#### 5.3 Capital Assessment

Review of:
- Share capital contribution
- Savings and deposits
- Other assets and investments
- Net worth calculation

#### 5.4 Collateral Assessment

Where applicable:
- Asset valuation
- Legal documentation
- Insurance coverage
- Marketability assessment

#### 5.5 Conditions Assessment

Consideration of:
- Economic environment
- Industry-specific risks
- Regulatory changes
- Market conditions

### 6. LOAN APPROVAL AUTHORITY

#### 6.1 Approval Limits

**Loan Officer:**
- Up to KES 50,000

**Credit Manager:**
- KES 50,001 to KES 200,000

**Credit Committee:**
- KES 200,001 to KES 1,000,000

**Board of Directors:**
- Above KES 1,000,000

#### 6.2 Committee Composition

The Credit Committee shall comprise:
- Credit Manager (Chairperson)
- Operations Manager
- Finance Manager
- Two (2) Board Members
- One (1) Member Representative

### 7. INTEREST RATES AND CHARGES

#### 7.1 Interest Rates

Standard rates (per annum):
- Development Loans: 12%
- Emergency Loans: 12%
- School Fees Loans: 12%
- Special Loans: 5% (monthly reducing balance)

#### 7.2 Fees and Charges

- Loan processing fee: 1% of loan amount
- Insurance premium: 0.5% of loan amount
- Late payment penalty: 2% per month on overdue amount
- Loan restructuring fee: 1% of outstanding balance

### 8. LOAN DISBURSEMENT

#### 8.1 Disbursement Methods

Approved loans may be disbursed through:
- Bank transfer to member\'s account
- M-Pesa mobile money transfer
- Cash collection at SACCO offices
- Cheque payment (for large amounts)

#### 8.2 Disbursement Timeline

- Standard loans: Within 5 working days of approval
- Emergency loans: Within 24 hours of approval
- Large loans (>KES 500,000): Within 10 working days

### 9. LOAN REPAYMENT

#### 9.1 Repayment Methods

Members may repay loans through:
- Automatic payroll deduction
- Bank standing orders
- M-Pesa payments
- Cash payments at SACCO offices
- Cheque payments

#### 9.2 Repayment Schedule

- Monthly installments on predetermined dates
- Equal monthly payments (principal + interest)
- Early repayment allowed without penalty
- Grace period: 10 days after due date

### 10. LOAN RECOVERY PROCEDURES

#### 10.1 Delinquency Management

**1-30 days overdue:**
- Automated reminder notifications
- Phone call reminders
- Email notifications

**31-60 days overdue:**
- Formal written notice
- Meeting with member
- Restructuring options discussion

**61-90 days overdue:**
- Final demand notice
- Guarantor notification
- Asset attachment procedures

**Over 90 days:**
- Legal action initiation
- Asset recovery procedures
- Write-off consideration

#### 10.2 Loan Restructuring

Criteria for restructuring:
- Temporary financial difficulties
- Good payment history prior to default
- Realistic repayment proposal
- Committee approval required

### 11. GUARANTORS AND COLLATERAL

#### 11.1 Guarantor Requirements

- Must be active SACCO members
- Good credit standing
- Adequate financial capacity
- Maximum guarantee exposure limits
- Written consent required

#### 11.2 Collateral Requirements

Acceptable collateral includes:
- Real estate property
- Motor vehicles
- Fixed deposits
- Shares and securities
- Business assets

### 12. LOAN MONITORING AND REVIEW

#### 12.1 Portfolio Monitoring

Regular monitoring includes:
- Monthly portfolio quality reports
- Delinquency trend analysis
- Concentration risk assessment
- Profitability analysis

#### 12.2 Policy Review

This policy shall be reviewed:
- Annually by the Credit Committee
- Upon significant regulatory changes
- Following major economic events
- As recommended by internal audit

### 13. REGULATORY COMPLIANCE

#### 13.1 SASRA Compliance

All lending activities must comply with:
- SACCO Societies Regulatory Authority (SASRA) regulations
- Prudential guidelines
- Reporting requirements
- Capital adequacy requirements

#### 13.2 Other Regulations

Compliance with:
- Co-operative Development Act
- Banking regulations (where applicable)
- Anti-money laundering requirements
- Data protection regulations

### 14. RISK MANAGEMENT

#### 14.1 Credit Risk Mitigation

Strategies include:
- Diversified loan portfolio
- Adequate provisioning
- Regular portfolio review
- Stress testing
- Insurance coverage

#### 14.2 Concentration Limits

Maximum exposure limits:
- Single borrower: 10% of core capital
- Related parties: 20% of core capital
- Unsecured loans: 25% of total portfolio
- Sector concentration: 25% per sector

### 15. APPEALS PROCESS

#### 15.1 Loan Application Appeals

Rejected applicants may appeal by:
- Submitting written appeal within 30 days
- Providing additional documentation
- Appearing before Appeals Committee
- Receiving written decision within 14 days

#### 15.2 Appeals Committee

Composition:
- Board Chairperson (or designate)
- Two Board Members
- General Manager
- Member Representative

### 16. POLICY IMPLEMENTATION

#### 16.1 Effective Date

This policy becomes effective on the date of Board approval and supersedes all previous credit policies.

#### 16.2 Training and Communication

- Staff training on policy provisions
- Member education programs
- Policy publication and distribution
- Regular updates and amendments

### 17. DEFINITIONS

**Active Member**: A member who has made contributions in the last six months
**Core Capital**: Paid-up share capital plus retained earnings
**Delinquent Loan**: A loan with payments overdue by more than 30 days
**Guarantor**: A member who provides security for another member\'s loan
**Non-Performing Loan**: A loan overdue by more than 90 days

---

**Document Control:**
- Version: 1.0
- Approved by: Board of Directors
- Effective Date: [Date]
- Next Review Date: [Date + 1 year]
- Document Owner: Credit Committee

**Contact Information:**
For questions about this policy, contact:
- Credit Department: credit@daystar.co.ke
- Phone: +254 123 456 789
- Address: Daystar SACCO Head Office

---

*This policy is subject to periodic review and may be amended as necessary to reflect changes in regulations, market conditions, or organizational requirements.*
';
}

/**
 * Create sample policy version for testing
 */
function create_sample_policy_version() {
    if (!current_user_can('manage_options')) {
        return false;
    }
    
    require_once get_template_directory() . '/includes/policy-management.php';
    
    $title = 'Daystar SACCO Credit Policy';
    $version_number = '1.0';
    $content = get_sample_policy_content();
    $effective_date = current_time('mysql');
    
    $result = PolicyManagementHandler::create_policy_version($title, $content, $version_number, $effective_date);
    
    return $result;
}

/**
 * Add admin action to create sample policy
 */
if (defined('WP_DEBUG') && WP_DEBUG) {
    add_action('admin_init', function() {
        if (isset($_GET['create_sample_policy']) && current_user_can('manage_options')) {
            $result = create_sample_policy_version();
            
            if ($result['success']) {
                wp_redirect(add_query_arg(array(
                    'page' => 'daystar-admin-policy',
                    'message' => 'Sample policy created successfully'
                ), admin_url('admin.php')));
            } else {
                wp_redirect(add_query_arg(array(
                    'page' => 'daystar-admin-policy',
                    'error' => $result['message']
                ), admin_url('admin.php')));
            }
            exit;
        }
    });
}